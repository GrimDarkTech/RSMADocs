# Настройка электродвигателей

[Switch to English](Manual/en/Motors/Setting_up_motors.md)

RSMA использует модуль **RSMAMotor2** для моделирования работы электродвигателей.

## Требования

- модель двигателя с настроенной физикой твердого тела
- модель тела, соединенного с валом двигателя (механическая передача, дифференциал, рабочий орган) с настроенными имитационными модулями
- модель драйвера электродвигателя с настроенными имитационными модулями

## Настройка имитационной модели электродвигателя на примере щеточного электродвигателя постоянного тока

Далее описаны шаги, необходимые для создания и настройки электродвигателя

## Подготовка объектов

Поместите объекты двигателя, драйвера и присоединяемого к двигателю тела на сцену Unity (рис. 1).
![](/Manual/_images/Setting_up_motors/Objects.png)
Рисунок 1 – Настраиваемые объекты

В окне "Hierarchy" выберите присоединяемый объект и отрегулируйте его вращение и положение с импользованием [инструментов Unity](https://docs.unity3d.com/Manual/PositioningGameObjects.html).
В рассматриваемом примере, колесо совмещено с валом электродвигателя (рис. 2).
![](/Manual/_images/Setting_up_motors/Placed.png)
Рисунок 2 – Колесо совмещено с валом двигателя

## Настройка компонента RSMAMotor2

В окне "Hierarchy" выберите объект двигателя (рис. 3).
![img](/Manual/_images/Setting_up_motors/Selected.png)
Рисунок 3 – Выбран двигатель DC12GMS

В окне "Inspector" используйте кнопку "Add Component" для поиска и добавления компонента RSMAMotor2 (рис. 4).
![](/Manual/_images/Setting_up_motors/AddComponent.png)
Рисунок 4 – Добавление компонента RSMAMotor2 в окне "Inspector"

Если RSMAMotor2 был успешно добавлен, он отобразится в окне инспектора (рис. 5).
![](/Manual/_images/Setting_up_motors/Component.png)
Рисунок 5 –  Компонент RSMAMotor2 в окне "Inspector"

Меню компонента RSMAMotor2 содержит следующие поля, используте их для настройки:

| Поле                  | Описание                                                                                                                                                                                                                                               | Тип                     | Значение                                  |
| ------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | -------------------------- | ------------------------------------------------- |
| MechanicalCharacteristics | Механическая характеристика двигателя, представленная графиком зависимости крутящего момента (нм) от угловой скорости вала (рад/c).              | UnityEngine.AnimationCurve | График функции                       |
| connectedBody             | Твердое тело, соединенное с валом двигателя                                                                                                                                                                               | UnityEngine.Rigidbody      | Ссылка                                      |
| motorDriver               | Драйвер, к которому подключен двигатель                                                                                                                                                                                      | RSMAMotorDriver            | Ссылка                                      |
| motorAxis                 | Ось вращения вала двигателя, заданая в его локальной системе координат                                                                                                                             | UnityEngine.Vector3        | Вектор единичной длины        |
| isResetMotorAnchor        | Если значение равно True, то выполняется сброс привязки оси вращения вала в соответствии с полями motorAnchor и connectedAnchor                                                 | System.Boolean             | True/False                                        |
| motorAnchor               | Координаты точки привязки в локальной системе координат двигателя. Определяет точку, через которую проходит ось вращения вала                      | UnityEngine.Vector3        | от ±1,5 x 10e−45 до ±3,4 x 10e38           |
| connectedAnchor           | Координаты точки привязки в локальной системе координат присоединяемого тела. Определяет точку, через которую проходит ось вращения вала | UnityEngine.Vector3        | от ±1,5 x 10e−45 до ±3,4 x 10e38           |
| brakingFactor             | Коэффициент торможения. Характеризует сопротивление вращению вала                                                                                                                                   | System.Single              | от ±1,5 x 10e−45 до ±3,4 x 10e38           |
| outputTorque              | Величина крутящего момента вала. Расчитывается автоматически                                                                                                                                             | UnityEngine.Vector3        | Заполняется автоматически |
| maxAngularVelocity        | Максимальное значение угловой скорости для присоединенного тела в радианах в секунду                                                                                                 | System.Single              | от ±1,5 x 10e−45 до ±3,4 x 10e38           |
| isDrawAnchors             | Если значение равно True, положение точек привязок отображается сферами, а ось - линиями                                                                                                  | System.Boolean             | True/False                                        |

### Заполнение поля MechanicalCharacteristics

Задайте механическую характеристику двигателя. Для этого наведите курсор на поле и нажмите правую кнопку мыши, откроеется окно редактора кривых (рис. 6).
![](/Manual/_images/Setting_up_motors/Curve.png)
Рисунок 6 –  Окно "Curve"

Двойным нажатием левой конпки мыши создайте точки для кривой, характеризующей настраиваемый двигатель. Перемещайте точки, наведя на них курсор и зажимая левую кнопку мыши. В рассматриваемом примере, двигатель постояноого тока паралельного возбуждения, его механическая характеристика - прямая линия (рис. 7), проходящая через точки (0, 0.035) и (16500, 0.032).
![](/Manual/_images/Setting_up_motors/MechanicalCharacteristics.png)
Рисунок 7 –  Механическая характеристика двигателя постоянного тока в окне "Curve"

### Заполнение поля ConnectedBody

Для заполнения поля connectedBody окне "Hierarchy" найдите присоединяемый объект (рабочий орган, механическая передача, дифференциал), наведите на него курсор, зажмите левую кнопку мыши и перенесите его в поле.

В рассматриваемом примере, объект колеса выбран и помещен в поле (рис. 8).
![](/Manual/_images/Setting_up_motors/ConnectedBody.png)
Рисунок 8 – Ссылка на объект колеса

### Заполнение поля MotorDriver

Для заполнения поля motorDriver окне "Hierarchy" найдите объект драйвера, наведите на него курсор, зажмите левую кнопку мыши и перенесите его в поле.

В рассматриваемом примере, двигатель подключен к драйверу L298N (рис. 9).
![](/Manual/_images/Setting_up_motors/MotorDriver.png)
Рисунок 9 – Значение поля motorDriver

### Заполнение поля MotorAxis

Для заполнения поля axis необходимо определить направление оси вращения вала в локальной системе координат двигателя.

Убедитесь, что инструмент перемещения объектов переключен на режим работы в локальных координатах, как показано на рисунке 10.
![](/Manual/_images/Setting_up_hinge_joints/ToolSettings.png)
Рисунок 10 – Настройки инструмента позиционирования объектов

В окне "Hierarchy" выберите объект двигателя. Выбранный объект выделится в окне "Scene". На выделенном объекте появится инструмент позиционирования (рис. 11).
![](/Manual/_images/Setting_up_motors/Axis.png)
Рисунок 11 – Инструмент позиционирования на выбранном объекте

Направления стрелок инструмента соотвествуют ориентации локальной системы координат объекта, где:

- синяя стрелка - ось Z (вперед);
- красная стрелка - ось X (вправо);
- зеленая стрелка - ось Y (вверх).

В рассматриваемом примере, ось вращения вала сонаправлена с синей стрелкой, что соотвествует оси Z.
Значение поля Axis - (0, 0, 1) - вектор единичной длины, сонаправленный с осью Z (рис. 12).
![](/Manual/_images/Setting_up_motors/AxisValue.png)
Рисунок 12 – Значение поля motorAxis

### Настройка точек привязки

Для отключения автоматической настройки точек привязки поставьте галочку в поле isResetAnchor.
Настройка точек привзяки производится с использованием полей MotorAnchor и ConnectedAnchor.

Включите отображение точек привязки, поставив галочку в поле isDrawAnchors. Точки прявзки будут отрисованы в окне "Scene", красная сфера - точка привязки двигателя, зеленая - присоединяемого тела. На рисунке 13 показаны точки электродвигателя и колеса.
![](/Manual/_images/Setting_up_motors/Anchors.png)
Рисунок 13 – Отображение точек привязки двигателя и колеса

Изменяя значение поля MotorAnchor переместите красную сферу в точку, в которой будет расположена ось вращения.
Изменяя значение поля ConnectedAnchor переместите зеленую сферу в точку, через которую будет проходить ось вращения.

После запуска моделирования соединение будет настроено так, что зеленая сфера совпадет с красной (рис. 14).
![](/Manual/_images/Setting_up_motors/AnchorSettings.png)
Рисунок 14 – Соединение после запуска моделирования

В рассматриваемом примере, заданы следующие настройки привзяки (рис. 15):
![](/Manual/_images/Setting_up_motors/Setted.png)
Рисунок 15 – Настройки привязки

После завершения настройки отключите отображение сфер, сняв галочку в поле isDrawAnchors.

### Настройка параметров вращения вала

Поле BrakingFactor определяет величину момента сопротивления вращению вала двигателя. Момент линейно зависит от скорости вращения.
Рекомендуемое значение - 0.05 (рис. 16). Изменяйте, в случае, если необходимо создать самотормозящийся двигатель или уменьшить сопротивление вращению.
![](/Manual/_images/Setting_up_motors/BreakingFactor.png)
Рисунок 16 – Значение поля BrakingFactor

Если вы ожидаете скорость вращения вала двигателя выше, чем 523 рад/с. Измените это значение в поле maxAngularVelocity.
Значение по умолчанию - 523. Поскольку двигатель рассматриваемый двигатель может развить скорость до 16000 рад/с, задано значение 16000 (рис. 17).
![](/Manual/_images/Setting_up_motors/MaxVelocity.png)
Рисунок 17 – Значение поля MaxAngularVelocity

## Задания

С целью получения опыта настройки электродвигателей и улучшения навыков работы с компонентом RSMAMotor2, настройте:

- электродвигатель постоянного тока с независимым возбуждение обмоток;
- асинхоронный электродвигатель переменного тока;
- синхоронный электродвигатель переменного тока.
- синхоронный электродвигатель переменного тока.
