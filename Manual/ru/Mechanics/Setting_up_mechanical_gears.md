# Настройка механических передач
[Switch to English](Manual/en/Mechanics/Setting_up_mechanical_gears.md)

RSMA использует модуль **Gearbox** для моделирования механических передач.
Вы можете использовать модуль для изменения направления оси вращения, величины угловой скорости и крутящего момента при работе с двигателями.

## Требования
- модель механической передачи с настроенной физикой твердого тела
- модель тела, соединенного с выходным валом передачи, с настроенной физикой твердого тела
- известное значение передаточного числа

## Настройка механической передачи на примере гипоидного редуктора
Далее описаны шаги, необходимые для сборки передачи и присоединения к ней твердого тела
## Подготовка объектов

Поместите объекты на сцену Unity (рис. 1).\
![](/Manual/_images/Setting_up_mechanical_gears/Objects.png)\
Рисунок 1 – Настраиваемые объекты

В окне "Hierarchy" выберите присоединяемый объект и отрегулируйте его вращение и положение с импользованием [инструментов Unity](https://docs.unity3d.com/Manual/PositioningGameObjects.html).
В рассматриваемом примере, колесо совмещено с выходным валом редуктора (рис. 2).\
![](/Manual/_images/Setting_up_mechanical_gears/Placed.png)\
Рисунок 2 – Колесо совмещено с редуктором

## Настройка компонента Gearbox

В окне "Hierarchy" выберите объект передачи (рис. 3).\
![](/Manual/_images/Setting_up_mechanical_gears/Selected.png)\
Рисунок 3 – Выбран редуктор

В окне "Inspector" используйте кнопку "Add Component" для поиска и добавления компонента Gearbox (рис. 4).\
![](/Manual/_images/Setting_up_mechanical_gears/AddComponent.png)\
Рисунок 4 – Добавление компонента Gearbox в окне "Inspector"

Если Gearbox был успешно добавлен, он и компонент Hinge Joint отобразятся в окне инспектора (рис. 5).\
![](/Manual/_images/Setting_up_mechanical_gears/Components.png)\
Рисунок 5 –  Компоненты Gearbox и Hinge Joint в окне "Inspector"

Меню компонента Gearbox содержит следующие поля, используте их для настройки параметров передачи:
| Поле | Описание | Тип | Значение|
|--|--|--|--|
|ratio|Передаточное число передачи|System.Single|от ±1,5 x 10e−45 до ±3,4 x 10e38|
|connectedBody|Твердое тело соединенное с выходным валом передачи|UnityEngine.Rigidbody|Ссылка|
|brakingFactor|Коэффициент торможения. Характеризует сопротивление вращению выходного вала|System.Single|от ±1,5 x 10e−45 до ±3,4 x 10e38|
|gearboxAxis|Ось вращения выходного вала, заданая в локальной системе координат объекта|UnityEngine.Vector3|Вектор единичной длины|
|isResetAnchor|Если значение равно True, то выполняется сброс привязки оси вращения в соответствии с полями anchor и connectedAnchor|System.Boolean|True/False|
|anchor|Координаты точки привязки в локальной системе координат объекта передачи. Определяет точку, через которую проходит ось вращения выходного вала|UnityEngine.Vector3|от ±1,5 x 10e−45 до ±3,4 x 10e38|
|connectedAnchor|Координаты точки привязки в локальной системе координат присоединяемого тела. Определяет точку, через которую проходит ось вращения|от ±1,5 x 10e−45 до ±3,4 x 10e38|UnityEngine.Vector3|
|maxAngularVelocity|Максимальное значение угловой скорости для присоединенного тела в радианах в секунду|System.Single|от ±1,5 x 10e−45 до ±3,4 x 10e38|
|isDrawAnchors|Если значение равно True, положение точек привязок отображается сферами, а ось - линиями|System.Boolean|True/False|
|outputTorque|Величина крутящего момента выходного вала. Расчитывается автоматически|UnityEngine.Vector3|Заполняется автоматически|

В поле Ratio укажите значение передаточного числа.
Если передача работает в режиме редуктора, как в рассматриваемом примере (рис. 6), модуль передаточного числа должен быть больше 1. Ввод отрицательного числа изменит направление вращения выходного вала.
Если передача работает в режиме мультипликатора, модуль передаточного числа меньше 1.
Если передача не изменяет величину крутящего момента, модуль передаточного числа - 1.\
![](/Manual/_images/Setting_up_mechanical_gears/Ratio.png)\
Рисунок 6 –  Значение поля Ratio

Для заполнения поля СonnectedBody окне "Hierarchy" найдите присоединяемый объект, наведите на него курсор, зажмите левую кнопку мыши и перенесите его в поле.
В рассматриваемом примере, выбран объект колеса и помещен в соответсвующие поле (рис. 7).\
![](/Manual/_images/Setting_up_mechanical_gears/ConnectedBody.png)\
Рисунок 7 – Ссылка на объект колеса

Поле BrakingFactor определяет величину момента сопротивления вращению выходного вала передачи. Момент линейно зависит от скорости вращения.
Рекомендуемое значение - 0.01 (рис. 8). Изменяйте, в случае, если необходимо создать самотормозящую передачу или избежать самоторможения передачи.\
![](/Manual/_images/Setting_up_mechanical_gears/BreakingFactor.png)\
Рисунок 8 – Значение поля BrakingFactor

Для заполнения поля GearboxAxis необходимо определить направление оси вращения в локальной системе координат объекта передачи.

Убедитесь, что инструмент перемещения объектов переключен на режим работы в локальных координатах, как показано на рисунке 9.\
![](/Manual/_images/Setting_up_hinge_joints/ToolSettings.png)\
Рисунок 9 – Настройки инструмента позиционирования объектов

В окне "Hierarchy" выберите объект передачи. Выбранный объект выделится в окне "Scene". На выделенном объекте появится инструмент позиционирования (рис. 10).\
![](/Manual/_images/Setting_up_mechanical_gears/Axis.png)\
Рисунок 10 – Инструмент позиционирования на передаче

Направления стрелок инструмента соотвествуют ориентации локальной системы координат объекта, где:
- синяя стрелка - ось Z (вперед);
- красная стрелка - ось X (вправо);
- зеленая стрелка - ось Y (вверх).

В рассматриваемом примере, ось вращения выходного вала направлена паралельно зеленой стрекле, что соотвествует оси Y.
Значение поля GearboxAxis - (0, 1, 0) - вектор единичной длины, сонаправленный с осью Y (рис. 11).\
![](/Manual/_images/Setting_up_mechanical_gears/AxisValue.png)\
Рисунок 11 – Значение поля GearboxAxis

Unity может выполнить автоматическую настройку точек привязки при создании осевого соединения, что очень удобно для пользователя. Однако это может привести к несоосности или прогибу соединения.
Для отключения автоматической настройки точек привязки поставьте галочку в поле isResetAnchor.
Настройка точек привзяки производится с использованием полей Anchor и ConnectedAnchor.

Включите отображение точек привязки, поставив галочку в поле isDrawAnchors. Точки прявзки будут отрисованы в окне "Scene", красная сфера - точка привязки объекта передачи, зеленая - присоединяемого. На рисунке 12 показаны точки привязки для редуктора и колеса.\
![](/Manual/_images/Setting_up_mechanical_gears/Anchors.png)\
Рисунок 12 – Отображение точек привязки

Изменяя значение поля Anchor переместите красную сферу в точку, в которой будет расположена ось вращения выходного вала (рис. 13).\
![](/Manual/_images/Setting_up_mechanical_gears/Anchor1.png)\
Рисунок 13 – Точка привязки редуктора

Изменяя значение поля ConnectedAnchor переместите зеленую сферу в точку, через которую будет проходить ось вращения (рис. 14). Если объекты изначально совмещены, как в рассматриваемом примере, сферы должны совпасть. Если объекты не были совмещены, после запуска моделирования произойдет автоматическое совмещение\
![](/Manual/_images/Setting_up_mechanical_gears/Anchor2.png)\
Рисунок 14 – Точка привязки колеса

В рассматриваемом примере, заданы следующие точки привзяки (рис. 15):\
![](/Manual/_images/Setting_up_mechanical_gears/Setted.png)\
Рисунок 15 – Настроенные точки привязки

После завершения настройки отключите отображение сфер, сняв галочку в поле isDrawAnchors.

Если вы ожидаете скорость вращения выходного вала передачи выше, чем 523 радиана в секунду. Измените это значение в поле maxAngularVelocity.
Значение по умолчанию - 523.

## Задания

С целью получения опыта настройки механических передач и улучшения навыков работы с компонентом Gearbox, настройте:
- цепную передачу;
- карданную передачу;
- цилиндирческий редуктор.
