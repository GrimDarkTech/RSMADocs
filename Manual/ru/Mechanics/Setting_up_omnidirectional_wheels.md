# Настройка роликонесущих колес
[Switch to English](Manual/en/Mechanics/Setting_up_omnidirectional_wheels.md)

RSMA использует модуль **OmnidirectionalWheel** для настройки роликонесущих колес.

## Требования
- модель основы колеса с настроенной физикой твердого тела
- модель ролика с настроенной физикой твердого тела

## Настройка роликонесущего колеса
Далее описаны шаги, необходимые для создания роликонесущего колеса
## Подготовка объектов

Поместите объект колеса и ролика на сцену Unity (рис. 1).\
![](/Manual/_images/Setting_up_omnidirectional_wheels/Objects.png)\
Рисунок 1 – Настраиваемые объекты

В окне "Hierarchy" щелкните правой кнопкой, во всплывающем меню выберите пункт "Create Empty" для создания пустого объекта и введите его название (рис. 2).\
![](/Manual/_images/Setting_up_omnidirectional_wheels/CreateEmpty.png)\
Рисунок 2 – Контекстное меню в окне "Hierarchy"

## Настройка компонента OmnidirectionalWheel

В окне "Hierarchy" выберите созданный объект (рис. 3).\
![](/Manual/_images/Setting_up_omnidirectional_wheels/Selected.png)\
Рисунок 3 – Выбран ранее созданный объект колеса

В окне "Inspector" используйте кнопку "Add Component" для поиска и добавления компонента OmnidirectionalWheel (рис. 4).\
![](/Manual/_images/Setting_up_omnidirectional_wheels/AddComponent.png)\
Рисунок 4 – Добавление компонента OmnidirectionalWheel в окне "Inspector"

Если OmnidirectionalWheel был успешно добавлен, он отобразится в окне инспектора (рис. 5).\
![](/Manual/_images/Setting_up_omnidirectional_wheels/Component.png)\
Рисунок 5 –  Компонент OmnidirectionalWheel в окне "Inspector"

Меню компонента OmnidirectionalWheel содержит следующие поля:
| Поле | Описание | Тип | Значение|
|--|--|--|--|
|wheel|Объект, используемый в качестве основы для всенаправленного колеса|UnityEngine.GameObject|Ссылка|
|wheelRotation|Настройка вращения объекта wheel|UnityEngine.Quaternion|Углы Эйлера|
|roller|Объект ролика, используемый для формирования всенаправленного колеса|UnityEngine.GameObject|Ссылка|
|rollerCount|Количество роликов, установленных на колесе|System.Int32|Целое число от 1 до 2147483647|
|installationRadius|Радиус установки роликов|System.Single|от +1,5 x 10−45 до +3,4 x 1038|
|additionalRollerRotation|Дополнительное вращение роликов|UnityEngine.Quaternion|Углы Эйлера|
|wheelPlane|Плоскость вращения колеса в локальной системе координат объекта|CoordinatePlane|Zx, Yz, Xy|
|rollerAngle|Угол наклона роликов относительно окружности колеса|System.Single|от 0 до 360|
|rollerRotationAxis|Ось, относительно которой ролик поворачивается к плоскости колеса|CoordinateAxis|X, Y, Z|
|rollerHingeAxis|Ось свободного вращения ролика|CoordinateAxis|X, Y, Z|

### Настройка колеса
Для заполнения поля wheel окне "Hierarchy" найдите объект основы колеса, наведите на него курсор, зажмите левую кнопку мыши и перенесите его в поле.

В рассматриваемом примере, выбран объект колеса и помещен в соответсвующие поле (рис. 6).\
![](/Manual/_images/Setting_up_omnidirectional_wheels/Wheel.png)\
Рисунок 6 – Ссылка на объект основы

Для заполнения поля roller окне "Hierarchy" найдите объект ролика, наведите на него курсор, зажмите левую кнопку мыши и перенесите его в поле.

В рассматриваемом примере, выбран объект ролика и помещен в соответсвующие поле (рис. 7).\
![](/Manual/_images/Setting_up_omnidirectional_wheels/Roller.png)\
Рисунок 7 – Ссылка на объект ролика

В поле rollerCount укажите количество роликов, которые необходимо установить на колесо (минимальное значение 1).
Для сборки колеса из примера используется 13 роликов (рис. 8).\
![](/Manual/_images/Setting_up_omnidirectional_wheels/Count.png)\
Рисунок 8 – Задано 13 роликов

В поле installationRadius укажите радиус установки роликов в метрах (минимальное значение 0).
В рассматриваемом примере, радиус - 17 мм (рис. 9).\
![](/Manual/_images/Setting_up_omnidirectional_wheels/Radius.png)\
Рисунок 9 – Задан радиус установки 17 мм

Для заполнения полей wheelPlane, rollerRotationAxis и rollerHingeAxis необходимо переключить инструмент перемещения объектов на режим работы в локальных координатах, как показано на рисунке 10.\
![](/Manual/_images/Setting_up_hinge_joints/ToolSettings.png)\
Рисунок 10 – Настройки инструмента позиционирования объектов

Выберите одну из основных плоскостей в локальной системе координат объекта (Zx, Yz, Xy) в качестве плоскости вращения колеса и установите ее в поле wheelPlane.
Для сборки колеса из примера используется плоскость Xy (рис. 11).\
![](/Manual/_images/Setting_up_omnidirectional_wheels/Plane.png)\
Рисунок 11 – Задана плоскость вращения колеса

Сформируйте колесо, нажатием кнопки "Form whell" в окне компонента OmnidirectionalWheel (рис. 12).\
![](/Manual/_images/Setting_up_omnidirectional_wheels/Button.png)\
Рисунок 12 – Кнопка "Form whell"

Если колесо успешно сформировано, оно отобразится в окне "Scene" (рис. 13). Колесо не будет сформировано, если поля Wheel и/или Roller не заданы.\
![](/Manual/_images/Setting_up_omnidirectional_wheels/Formed.png)\
Рисунок 13 – Сформированное колесо

На рисунке 13 видно, что ориентация основания колеса не совпадает с заданной ранее плоскостью колеса.
Для решения подобных проблем используте поле WheelRotation, изменяя вращение основы колеса. Чтобы изменения вступили в силу сформируйте колесо заново, нажатием кнопки "Form whell".

Для корректировки колеса из примера задано значение вращения 270 градусов вокруг оси Y (рис. 14).\
![](/Manual/_images/Setting_up_omnidirectional_wheels/WheelRotation.png)\
Рисунок 14 – Значение поля WheelRotation

После применения изменений вращение основания исправлено, однако ролики не расположены по касательной к окружности колеса (рис. 15).\
![](/Manual/_images/Setting_up_omnidirectional_wheels/WheelRotated.png)\
Рисунок 15 – Некорректная ориентация роликов

Для изменения вращения роликов используте поле AdditionalRollerRotation. Измените значение так, чтобы ось вращения роликов касалась окружности колеса.
Для рассматриваемого колеса, задан дополнительный поворот роликов на 90 градусов вокруг оси Z (рис. 16).\
![](/Manual/_images/Setting_up_omnidirectional_wheels/RollerRotation.png)\
Рисунок 16 – Значение поля AdditionalRollerRotation

После применения изменений ролики лежат в плоскости колеса (рис. 17).\
![](/Manual/_images/Setting_up_omnidirectional_wheels/RollerRotationFixed.png)\
Рисунок 17 – Ролики в плоскости колеса

В некоторых типы роликонесущих колес, например, в колесах Mecanum, ролики повернуты отностительно окружности колеса. Рассматриваемое в качестве примера колесо являеется колесом Mecanum, его ролики должны быть повернуты на 45 градусов к плоскости колеса.

Чтобы задать величину угла и ось поворота роликов используейте поля RollerAngle и RollerRotationAxis соответственно.
Для этого в окне "Hierarchy" разверните список дочерних объектов колеса и выберите любой ролик, он выделится в окне "Scene", и на нем появится инструмент позиционирования (рис. 19).\
![](/Manual/_images/Setting_up_omnidirectional_wheels/RollerSelected.png)\
Рисунок 19 – Инструмент позиционирования на выбранном ролике

Направления стрелок инструмента соотвествуют ориентации локальной системы координат объекта, где:
- синяя стрелка - ось Z (вперед);
- красная стрелка - ось X (вправо);
- зеленая стрелка - ось Y (вверх).

Укажите в поле RollerAngle угол поворота, в RollerRotationAxis - ось, направленную по радуису колеса.
В рассматриваемом примере это ось Y.

Для поворта роликов по оси Y на 45 градусов заданы следующие параметры (рис. 20):\
![](/Manual/_images/Setting_up_omnidirectional_wheels/RollerRotated.png)\
Рисунок 20 – Настройки для поворота роликов на 45 градусов к плоскости колеса

После применения изменений ролики повернулись на заданный угол (рис. 21).\
![](/Manual/_images/Setting_up_omnidirectional_wheels/RollerSetted.png)\
Рисунок 21 – Ролики настроены

Для настройки оси свободного вращения роликов используйте поле RollerHingeAxis.
Для определения оси вращения ролика в окне "Hierarchy" разверните список дочерних объектов колеса и выберите любой ролик, он выделится в окне "Scene", и на нем появится инструмент позиционирования (рис. 22).\
![](/Manual/_images/Setting_up_omnidirectional_wheels/RollerAxis.png)\
Рисунок 22 – Инструмент позиционирования на выбранном ролике

Укажите в поле RollerHingeAxis ось, направленную по касательной к радиусу колеса.
В рассматриваемом примере это ось X. Переформируйте колесо

## Задания

С целью получения опыта настройки роликонесущих колес и улучшения навыков работы с компонентом OmnidirectionalWheel, соберите:
- омниколесо с друмя рядами роликов, соединив два однорядных колеса;
- набор колес с наклоном роликов 75 градусов;
- набор колес Mecanum для четырехколесной платформы.
