# Настройка драйверов электродивагеля
[Switch to English](/Manual/en/Electronics/Setting_up_motor_drivers.md)

В RSMA для моделирования работы драйверов электродвигателя используются компоненты:
- **RSMAMotorDriver** - управление электродвигателями постоянного/переменного тока
- **StepperDriver** - управление шаговыми электродвигателями

## Требования
- модель объекта драйвера с настроенной физикой твердого тела
- настроенный микроконтроллер, к которому подлкючен драйвер

## Настройка драйвера электродвигателя на примере L298N

## Подготовка объектов

Поместите объект драйвера на сцену Unity (рис. 1).\
![](/Manual/_images/Setting_up_motor_drivers/Object.png)\
Рисунок 1 – Настраиваемый объект

## Добавление компонента RSMAMotorDriver

В окне "Hierarchy" выберите объект драйвера (рис. 2).\
![](/Manual/_images/Setting_up_motor_drivers/Selected.png)\
Рисунок 2 – Выбран объект L298N

В окне "Inspector" используйте кнопку "Add Component" для поиска и добавления компонента RSMAMotorDriver (рис. 3).\
![](/Manual/_images/Setting_up_motor_drivers/AddComponent1.png)\
Рисунок 3 – Добавление компонента RSMAMotorDriver в окне "Inspector"

Если компонент был успешно добавлен, он отобразится в окне инспектора (рис. 4).\
![](/Manual/_images/Setting_up_motor_drivers/Component1.png)\
Рисунок 4 –  Компонент в окне "Inspector"

## Подключение RSMAMotorDriver к микроконтроллеру

Для подключения драйвера к выводам порта GPIO микроконтроллера используйте поля:
- ConnectMicrocontroller - микроконтроллер, к которому подключен драйвер;
- ConnectedPin1 - вывод порта GPIO микроконтроллера, подключенный к первому входу драйвера;
- ConnectedPin2 - вывод порта GPIO микроконтроллера, подключенный ко второму входу драйвера;
- ConnectedPinPWM - вывод порта GPIO микроконтроллера, подключенный к ШИМ входу драйвера.

Для заполнения поля ConnectMicrocontroller в окне "Hierarchy" наведите курсор на микроконтроллер, к которому будет подключен драйвер, зажмите левую кнопку мыши и перенесите его в поле ConnectMicrocontroller.

Разверните список параметров поля ConnectedPin1, в поле PortName укажите имя порта GPIO, к которому подключен первый вход драйвера, в поле PinName - имя вывода порта GPIO, к которому подключен первый вход драйвера.
Аналогичным образом укажите поля ConnectedPin1 и ConnectedPinPWM.

В рассматриваемом примере, драйвер подключен к STM32F103C8. Первый вход подключен к выводу 1 порта PA, второй - к выводу 2 порта PA, порт ШИМ - к выводу 4 порта PA (рис. 5).\
![](/Manual/_images/Setting_up_motor_drivers/Setted1.png)\
Рисунок 5 – Значение полей для подключения микроконтроллера

Поскольку L298N поддерживает подключение двух электродвигателей постоянного тока, аналогичным образом добавлен и настроен второй компонент RSMAMotorDriver, но подключенный к порту PB (рис. 6).\
![](/Manual/_images/Setting_up_motor_drivers/Added1.png)\
Рисунок 6 – Второй компонент RSMAMotorDriver

## Добавление компонента StepperDriver

В окне "Hierarchy" выберите объект драйвера (рис. 7).\
![](/Manual/_images/Setting_up_motor_drivers/Selected.png)\
Рисунок 7 – Выбран объект L298N

В окне "Inspector" используйте кнопку "Add Component" для поиска и добавления компонента StepperDriver (рис. 8).\
![](/Manual/_images/Setting_up_motor_drivers/AddComponent2.png)\
Рисунок 8 – Добавление компонента RSMAMotorDriver в окне "Inspector"

Если компонент был успешно добавлен, он отобразится в окне инспектора (рис. 9).\
![](/Manual/_images/Setting_up_motor_drivers/Component2.png)\
Рисунок 9 –  Компонент в окне "Inspector"

## Подключение StepperDriver к микроконтроллеру

Для подключения драйвера к выводам порта GPIO микроконтроллера используйте поля:
- ConnectMicrocontroller - микроконтроллер, к которому подключен драйвер;
- Channel1Pin - вывод порта GPIO микроконтроллера, подключенный к первому каналу драйвера;
- Channel2Pin - вывод порта GPIO микроконтроллера, подключенный ко второму каналу драйвера;
- Channel3Pin - вывод порта GPIO микроконтроллера, подключенный к третьему каналу драйвера;
- Channel4Pin - вывод порта GPIO микроконтроллера, подключенный к четвертому каналу драйвера;

Для заполнения поля ConnectMicrocontroller в окне "Hierarchy" наведите курсор на микроконтроллер, к которому будет подключен драйвер, зажмите левую кнопку мыши и перенесите его в поле ConnectMicrocontroller.

Разверните список параметров поля Channel1Pin, в поле PortName укажите имя порта GPIO, к которому подключен первый канал драйвера, в поле PinName - имя вывода порта GPIO, к которому подключен первый канал драйвера.
Аналогичным образом укажите поля Channel2Pin, Channel3Pin и Channel4Pin.

В рассматриваемом примере, драйвер подключен к STM32F103C8. Первый канал подключен к выводу 1 порта PA, второй - к выводу 2 порта PA, третий - к выводу 3 порта PA, четвертый- к выводу 4 порта PA (рис. 10).\
![](/Manual/_images/Setting_up_motor_drivers/Setted2.png)\
Рисунок 10 – Значение полей для подключения микроконтроллера

## Задания

С целью получения опыта настройки драйверов электродвигателя и улучшения навыков работы с компонентомами RSMAMotorDriver и StepperDriver, соберите:
- драйвер MX1508;
- драйвер TA6586;
- драйвер L9110S.

