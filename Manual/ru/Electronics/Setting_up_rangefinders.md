# Настройка дальномера
[Switch to English](/Manual/en/Electronics/Setting_up_rangefinders.md)

В RSMA для моделирования работы дальномеров используется компонент **RSMARangeFinderBase**

## Требования
- модель объекта дальномера с настроенной физикой твердого тела

## Настройка модуля на примере ультразвукового дальномера HC05
Далее описаны шаги, необходимые для настройки компонента RSMARangeFinderBase
## Подготовка объектов

Поместите объект дальномера на сцену Unity (рис. 1).\
![](/Manual/_images/Setting_up_rangefinders/Object.png)\
Рисунок 1 – Настраиваемый объект

Для корректной настройки модуля необходимо, чтобы передняя часть дальномера (сторона, где расположен излучатель) была направлен по оси Z в локальной системе координат. При этом верхняя часть дальномера была направлена по оси Y.

Убедитесь, что инструмент перемещения объектов переключен на режим работы в локальных координатах, как показано на рисунке 2.\
![](/Manual/_images/Setting_up_hinge_joints/ToolSettings.png)\
Рисунок 2 – Настройки инструмента позиционирования объектов

В окне "Hierarchy" выберите объект дальномера. Выбранный объект выделится в окне "Scene". На выделенном объекте появится инструмент позиционирования (рис. 3).
Убедитесь, что векторы локальной системы координат совпадают с векторами, показанными на рисунке 3.\
![](/Manual/_images/Setting_up_rangefinders/Axis.png)\
Рисунок 3 – Инструмент позиционирования на выбранном объекте

Направления стрелок инструмента соотвествуют ориентации локальной системы координат объекта, где:
- синяя стрелка - ось Z (вперед);
- красная стрелка - ось X (вправо);
- зеленая стрелка - ось Y (вверх).

Если локальная система координат повернута и не совпадает, создайте родительский объект для модели дальномера. Для этого щелкните правой кнопкой мыши на объекте в окне "Hierarchy", выберите пункт "Create Empty Parent" (рис. 4) и введите имя нового объекта.\
![1716849814319](/Manual/_images/Setting_up_the_physics_of_models/1716849814319.png)\
Рисунок 4 – Создание родительского объекта

В окне "Hierarchy" выберите дочерний объект и отрегулируйте его вращение и положение с импользованием [инструментов Unity](https://docs.unity3d.com/Manual/PositioningGameObjects.html)

## Добавление компонента RSMARangeFinderBase

В окне "Hierarchy" выберите объект дальномера (рис. 5).\
![](/Manual/_images/Setting_up_rangefinders/Selected.png)\
Рисунок 5 – Выбран объект HC05

В окне "Inspector" используйте кнопку "Add Component" для поиска и добавления компонента RSMARangeFinderBase (рис. 6).\
![](/Manual/_images/Setting_up_rangefinders/AddComponent.png)\
Рисунок 6 – Добавление компонента RSMARangeFinderBase в окне "Inspector"

Если компонент был успешно добавлен, он отобразится в окне инспектора (рис. 7).\
![](/Manual/_images/Setting_up_rangefinders/Component.png)\
Рисунок 7 –  Компонент в окне "Inspector"

## Настройка компонента RSMARangeFinderBase

Меню компонента RSMARangeFinderBase содержит следующие поля, используте их для настройки:
| Поле | Описание | Тип | Значение|
|--|--|--|--|
|maxRange|Максимальное расстояние в метрах, которое может измерить дальномер|System.Single|от 0 до ±3,4 x 10e38|
|angle|Угол обзора дальномера в градусах. Лежит в плоскости ZX. Ось Z - бисекрисса угла|System.Single|от ±1,5 x 10e−45 до ±3,4 x 10e38|
|numberOfRays|Количество лучей, используемых для измерения|System.Int32|от -2147483647 до 2147483647|
|isDrawRays|Если значение равно True, будут отображены лучи, используемые для измерения расстояния|System.Boolean|True/False|

Укажите максимальное расстояние в метрах, измеряемое дальномером, в поле maxRange. Для дальномера HC05 максимальное измеряемое расстояние - 8 метров (рис. 8).\
![](/Manual/_images/Setting_up_rangefinders/MaxRange.png)\
Рисунок 8 – Значение поля maxRange

Установите значение рабочего угла дальномера в градусах. Для этого используйте поле angle. В рассматриваемом примере, угол обзора 50 градусов (рис. 9).\
![](/Manual/_images/Setting_up_rangefinders/Angle.png)\
Рисунок 9 – Значение поля angle

Настройте количество лучей, используемых для измерения. Для этого включите отображение лучей, поставив галочку в поле isDrawRays.
Изменяйте значение поля numberOfRays, чтобы получить необходимую плотность лучей.

Например, при значении поля 10 лучей, с учетом максимальной дальности 8 метров и рабочего угла 50 градусов, HC05 не обнаружит объект, размер которого меньше 50 сантиметров (рис. 10).\
![](/Manual/_images/Setting_up_rangefinders/Rays10.png)\
Рисунок 10 – Плотность лучей

При значении 15, дальномер обнаружит объект (рис. 11)\.
![](/Manual/_images/Setting_up_rangefinders/Rays15.png)\
Рисунок 11 – Плотность лучей

Задате величину свободного хода штока, используя поле stockFreeStroke.
Для настраиваемой модели величина свободного хода - 1 см (рис. 10).\
![](/Manual/_images/Setting_up_switches/FreeStroke.png)\
Рисунок 10 – Объект не обнаружен

Укажите коэффициент жесткости пружины выключателя в поле springStiffness. В рассматриваемом примере, жесткость пружины составляет 200 Н/м (рис. 11).\
![](/Manual/_images/Setting_up_switches/Stiffness.png)\
Рисунок 11 – Объект обнаружен

После завершения настройки отключите отображение лучей, сняв галочку в поле isDrawRays.

## Задания

С целью получения опыта настройки дальномеров и улучшения навыков работы с компонентом RSMARangeFinderBase, соберите:
- Ультразвуковой дальномер;
- Лазерный дальномер.
